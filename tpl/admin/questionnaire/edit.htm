<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>问卷</title>
<link rel="stylesheet"
	href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
<script
	src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container">
		<h1>新建内容</h1>
		<div class="row">
			<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
				<div class="btn-group-vertical">
					<button id="myButtons1" type="button" class="btn btn-default">单选题</button>
					<button id="myButtons2" type="button" class="btn btn-default">多选题</button>
					<button id="myButtons3" type="button" class="btn btn-default">下拉题</button>
					<button id="myButtons4" type="button" class="btn btn-default">单行文字</button>
					<button id="myButtons5" type="button" class="btn btn-default">多行文本</button>
					<button id="myButtons6" type="button" class="btn btn-default">填空题</button>
					<button id="myButtons7" type="button" class="btn btn-default">按钮
						1</button>
					<button id="myButtons8" type="button" class="btn btn-default">按钮
						2</button>
					<p class="active-tab">
						<strong>激活的标签页</strong>：<span></span>
					</p>
					<p class="previous-tab">
						<strong>前一个激活的标签页</strong>：<span></span>
					</p>
				</div>
			</div>
			<div class="col-xs-9 col-sm-9 col-md-9 col-lg-9">
				<ul id="myTab" class="nav nav-tabs">
					<li class="active"><a href="#home" data-toggle="tab">设计</a></li>
					<li><a href="#view" data-toggle="tab">预览</a></li>
				</ul>
				<div id="myTabContent" class="tab-content">
					<div class="tab-pane fade in active" id="home">
						<div id="preview">
							<h1 id='nairetitlelab'><?php if(empty($questionnaire->title())) echo "添加标题";else echo $questionnaire->title(); ?></h1>
							<input type="text" name="nairetitle" id="nairetitle"
										class="form-control" placeholder="标题" style="display: none;">
							<h2 id='nairenoteslab'><?php if(empty($questionnaire->notes())) echo "添加备注";else echo $questionnaire->notes(); ?></h2>
							<input type="text" name="nairenotes" id="nairenotes"
										class="form-control" placeholder="备注" style="display: none;">
							
							<div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">
								<label id='title' for="name">内联的复选框和单选按钮的实例</label>
								<div>
									<label class="checkbox-inline"> <input type="checkbox"
										id="inlineCheckbox1" value="option1"> 选项 1
									</label> <label class="checkbox-inline"> <input type="checkbox"
										id="inlineCheckbox2" value="option2"> 选项 2
									</label> <label class="checkbox-inline"> <input type="checkbox"
										id="inlineCheckbox3" value="option3"> 选项 3
									</label> <label class="radio-inline"> <input type="radio"
										name="optionsRadiosinline" id="optionsRadios3" value="option1"
										checked> 选项 1
									</label> <label class="radio-inline"> <input type="radio"
										name="optionsRadiosinline" id="optionsRadios4" value="option2">
										选项 2
									</label>
								</div>
							</div>
							<div
								class="col-xs-2 col-sm-2 col-md-2 col-lg-2 btn-group-vertical input-group-sm">
								<button type="button" id="edit" class="btn btn-default">按钮 1</button>
								<button type="button" id="del" class="btn btn-default">按钮 2</button>
							</div>
							
							
						</div>
						<hr>
						<div id="editview">
						
						
							<form class="form-horizontal" role="form">
								<div class="input-group input-group-lg input-group-sm">
									<span class="input-group-addon">标题</span> <input type="text" name="title"
										class="form-control" placeholder="twitterhandle">
								</div>
								<br>
								<div class="input-group input-group-lg input-group-sm">
									<span class="input-group-addon">备注</span> <input type="text" name="notes"
										class="form-control" placeholder="twitterhandle">
								</div>
								<br>
								<div class="input-group input-group-lg input-group-sm">
									<span class="input-group-addon">选项</span> <input type="text" name="checktitle"
										class="form-control" placeholder="twitterhandle"><span
										class="input-group-addon glyphicon glyphicon-remove"></span>
								</div>

								<br>
								<div class="input-group input-group-lg input-group-sm">
									<span class="input-group-addon">选项</span> <input type="text" name="checktitle"
										class="form-control" placeholder="twitterhandle"><span
										class="input-group-addon glyphicon glyphicon-remove"></span>
								</div>
								<br>
								<div class="form-group input-group-lg input-group-sm">
									<label for="choiceadd"
										class="col-xs-1 col-sm-1 col-md-1 col-lg-1 control-label">选项</label>
									<button type="button" id='add_check_btn'
										class="col-xs-10 col-sm-10 col-md-10 col-lg-10 btn btn-default">添加选项</button>
								</div>
								<br>
								<div class="form-group input-group-lg input-group-sm">
									<button type="button" id='add_check'
										class="btn btn-default">添加</button>
									<button type="reset" id='reset'
										class="btn btn-default">重置</button>
								</div>
							</form>
							
							
						</div>
					</div>
					<div class="tab-pane fade" id="view">
						<p>iOS 是一个由苹果公司开发和发布的手机操作系统。最初是于 2007 年首次发布 iPhone、iPod Touch
							和 Apple TV。iOS 派生自 OS X，它们共享 Darwin 基础。OS X 操作系统是用在苹果电脑上，iOS
							是苹果的移动版本。</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script>
		$(function() {
			//			$('#myTab li:eq(1) a').tab('show');
			$('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
				// 获取已激活的标签页的名称
				var activeTab = $(e.target).text();
				// 获取前一个激活的标签页的名称
				var previousTab = $(e.relatedTarget).text();
				$(".active-tab span").html(activeTab);
				$(".previous-tab span").html(previousTab);
			});
		});
		$(function() {
			$("#nairetitlelab").click(function() {
				$(this).hide();
				$("#nairetitle").show();
				$("#nairetitle").val($("#nairetitlelab").text());
			});
		});
		$(function() {
			$("#nairetitle").blur(function() {
				$("#nairetitle").hide();
				$("#nairetitlelab").text($("#nairetitle").val());
				$("#nairetitlelab").show();
				$.post("index.php?admin/questionnaire/editTitle", { id:<?php echo $questionnaire->id(); ?>, title: $("#nairetitle").val(), notes:$("#nairenoteslab").text() } );
			});
		});
		$(function() {
			$("#nairenoteslab").click(function() {
				$(this).hide();
				$("#nairenotes").show();
				$("#nairenotes").val($("#nairenoteslab").text());
			});
		});
		$(function() {
			$("#nairenotes").blur(function() {
				$("#nairenotes").hide();
				$("#nairenoteslab").text($("#nairenotes").val());
				$("#nairenoteslab").show();
				$.post("index.php?admin/questionnaire/editTitle", { id:<?php echo $questionnaire->id(); ?>, title: $("#nairetitle").val(), notes:$("#nairenoteslab").text() } );
			});
		});
		$(function() {
			$("#myButtons1").click(function() {
				//var p = '<label for="name">内联的复选框和单选按钮的实例</label><div><label class="checkbox-inline"> <input type="checkbox" id="inlineCheckbox1" value="option1"> 选项 1 </label> <label class="checkbox-inline"> <input type="checkbox" id="inlineCheckbox2" value="option2"> 选项 2 </label> <label class="checkbox-inline"> <input type="checkbox" id="inlineCheckbox3" value="option3"> 选项 3 </label> </div>';
				//			var d = document.createElement("div");
				//		    d.innerHTML = "生成的div:" + count;
				//		    d.style.height = "25px";
				//		    count++;
				//				alert(p);
				//$("#preview").append(p);
				$("#editview").empty();
				var d = '<h4>添加多选</h4><form class="form-horizontal" role="form">'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">标题</span> <input type="text" name="title"'
					+' class="form-control" placeholder="标题">'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">备注</span> <input type="text" name="notes"'
					+' class="form-control" placeholder="备注">'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">选项</span> <input type="text" name="checktitle"'
					+' class="form-control" placeholder="选项"><span'
					+' class="input-group-addon glyphicon glyphicon-remove"></span>'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">选项</span> <input type="text" name="checktitle"'
					+' class="form-control" placeholder="选项"><span'
					+' class="input-group-addon glyphicon glyphicon-remove"></span>'
					+'</div>'
					+'<br>'
					+'<div class="form-group input-group-lg input-group-sm">'
					+'<label for="choiceadd"'
					+' class="col-xs-1 col-sm-1 col-md-1 col-lg-1 control-label">选项</label>'
					+'<button type="button" id="add_check_btn"'
					+' class="col-xs-10 col-sm-10 col-md-10 col-lg-10 btn btn-default">添加选项</button>'
					+'</div>'
					+'<br>'
					+'<div class="form-group input-group-lg input-group-sm">'
					+'<button type="button" id="add_check"'
					+' class="btn btn-default">添加</button>'
					+'<button type="reset" id="reset"'
					+' class="btn btn-default">重置</button>'
					+'</div>'
					+'</form>';
				$("#editview").append(d);
			});
		});
		$(function() {
			$("#myButtons2").click(function() {
				//var p = '<label for="name">内联的复选框和单选按钮的实例<div></label><label class="radio-inline"> <input type="radio" name="optionsRadiosinline" id="optionsRadios3" value="option1" checked> 选项 1 </label> <label class="radio-inline"> <input type="radio" name="optionsRadiosinline" id="optionsRadios4" value="option2"> 选项 2 </label></div>';
				//$("#preview").append(p);
				$("#editview").empty();
				var d = '<h4>添加单选</h4><form class="form-horizontal" role="form">'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">标题</span> <input type="text" name="title"'
					+' class="form-control" placeholder="标题">'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">备注</span> <input type="text" name="notes"'
					+' class="form-control" placeholder="备注">'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">选项</span> <input type="text" name="checktitle"'
					+' class="form-control" placeholder="选项"><span'
					+' class="input-group-addon glyphicon glyphicon-remove"></span>'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">选项</span> <input type="text" name="checktitle"'
					+' class="form-control" placeholder="选项"><span'
					+' class="input-group-addon glyphicon glyphicon-remove"></span>'
					+'</div>'
					+'<br>'
					+'<div class="form-group input-group-lg input-group-sm">'
					+'<label for="choiceadd"'
					+' class="col-xs-1 col-sm-1 col-md-1 col-lg-1 control-label">选项</label>'
					+'<button type="button" id="add_check_btn"'
					+' class="col-xs-10 col-sm-10 col-md-10 col-lg-10 btn btn-default">添加选项</button>'
					+'</div>'
					+'<br>'
					+'<div class="form-group input-group-lg input-group-sm">'
					+'<button type="button" id="add_radio"'
					+' class="btn btn-default">添加</button>'
					+'<button type="reset" id="reset"'
					+' class="btn btn-default">重置</button>'
					+'</div>'
					+'</form>';
				$("#editview").append(d);
			});
		});
		$(function() {
			$("#myButtons4").click(function() {
				$("#myButtons4").toggle();
			});
		});
		$(function() {
			$("#myButtons4").click(function() {
				$("#myButtons4").toggle();
			});
		});
		//		$(function() {
		//			$('.input-group').find('span.glyphicon').click(function() {
		//				$(this).parent().empty();
		//			});
		//		});
		$(function() {
			$("#editview").on("click",".form-horizontal > .input-group > span.glyphicon-remove", function(e) {
				$(e.target).parent().next().remove();
				$(e.target).parent().remove();
			});
		});
		$(function() {
			$("#editview").on("click",".form-horizontal > .form-group > #add_check_btn", function(e) {
				$(this).parent().before('<div class="input-group input-group-lg input-group-sm"><span class="input-group-addon">选项</span> <input type="text" name="checktitle" class="form-control" placeholder="选项"><span class="input-group-addon glyphicon glyphicon-remove"></span></div><br>');
			});
		});
		$(function() {
			$('.form-group').click(function() {
				$(this).find('span.glyphicon').parent().parent().remove();
			});
		});
		$(function() {
			$("#editview").on("click",".form-horizontal > .form-group > #add_check", function(e) {
				title = $("#editview >.form-horizontal > .input-group > input[name='title']").val();
				notes = $("#editview >.form-horizontal > .input-group > input[name='notes']").val();
				var p = '<div class="col-xs-10 col-sm-10 col-md-10 col-lg-10"><label for="name"><label id="title">'+title+'</label>:<label id="notes">'+notes+'</label></label><div>';
				var options = new Array();
				$("#editview >.form-horizontal > .input-group > input[name='checktitle']").each(function(i) {
					options.push($(this).val());
					p = p+ '<label class="checkbox-inline"><input type="checkbox" id="inlineCheckbox" value="'+i+'"> '+ $(this).val() +' </label>';
				}); 
				p = p+'</div></div><div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 btn-group-vertical input-group-sm">'
					+'<button type="button" class="btn btn-default">编辑</button><button type="button" class="btn btn-default">删除</button></div>';
				$("#preview").append(p);
				$("#editview").empty();
				
				$.post("index.php?admin/questionnaire/addQuestions", 
					{ nid:<?php echo $questionnaire->id(); ?>, 'title': title, 'notes': notes, 'type':'check', 'titles': options, 'values': options }, function(data){
				     alert(data); // John
			   }, "json");
			});
		});
		$(function() {
			$("#editview").on("click",".form-horizontal > .form-group > #add_radio", function(e) {
				title = $("#editview >.form-horizontal > .input-group > input[name='title']").val();
				notes = $("#editview >.form-horizontal > .input-group > input[name='notes']").val();
				var p = '<div class="col-xs-10 col-sm-10 col-md-10 col-lg-10"><label id="title">'+title+'</label>:<label id="notes">'+notes+'</label><div>';
				$("#editview >.form-horizontal > .input-group > input[name='checktitle']").each(function(i) {
					p = p+ '<label class="radio-inline"> <input type="radio" name="optionsRadiosinline" id="optionsRadios" value="'+i+'"> '+ $(this).val() +' </label>';
				}); 
				p = p+'</div></div><div class="col-xs-2 col-sm-2 col-md-2 col-lg-2 btn-group-vertical input-group-sm">'
					+'<button type="button" id="edit" class="btn btn-default">编辑</button><button type="button" id="del" class="btn btn-default">删除</button></div>';
				$("#preview").append(p);
				$("#editview").empty();
			});
		});
		$(function() {
			$("#preview").on("click",".btn-group-vertical > #edit", function(e) {
				title = $("#preview > div > #title").text();
				notes = $("#preview > div > #notes").text();
				$("#editview").empty();
				var d = '<h4>添加单选</h4><form class="form-horizontal" role="form">'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">标题</span> <input type="text" name="title"'
					+' class="form-control" placeholder="标题" value="'+title+'">'
					+'</div>'
					+'<br>'
					+'<div class="input-group input-group-lg input-group-sm">'
					+'<span class="input-group-addon">备注</span> <input type="text" name="notes"'
					+' class="form-control" placeholder="备注" value="'+notes+'">'
					+'</div>'
					+'<br>';

					//+'<div class="input-group input-group-lg input-group-sm">'
					//+'<span class="input-group-addon">选项</span> <input type="text" name="checktitle"'
					//+' class="form-control" placeholder="选项" value="'+title+'"><span'
					//+' class="input-group-addon glyphicon glyphicon-remove"></span>'
					//+'</div>'
					//+'<br>'
					
					
					d = d + '<div class="form-group input-group-lg input-group-sm">'
					+'<label for="choiceadd"'
					+' class="col-xs-1 col-sm-1 col-md-1 col-lg-1 control-label">选项</label>'
					+'<button type="button" id="add_check_btn"'
					+' class="col-xs-10 col-sm-10 col-md-10 col-lg-10 btn btn-default">添加选项</button>'
					+'</div>'
					+'<br>'
					+'<div class="form-group input-group-lg input-group-sm">'
					+'<button type="button" id="add_radio"'
					+' class="btn btn-default">添加</button>'
					+'<button type="reset" id="reset"'
					+' class="btn btn-default">重置</button>'
					+'</div>'
					+'</form>';
				$("#editview").append(d);
			});
		});
		$(function() {
			$("#preview").on("click",".btn-group-vertical > #del", function(e) {
				$(e.target).parent().prev().remove();
				$(e.target).parent().remove();
			});
		});
	</script>
</body>
</html>

